<style type="text/css">
  legend{border-bottom: 0px;}
</style>

<script type="text/javascript" src="/static/js/jquery.uploadify.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.uploadify.js"></script>
<script type="text/javascript" src="/static/js/jquery.easyui.min.js"></script>
<script type="text/javascript">
  $(document).ready(function () {
    $('#RoomIco').uploadify({
        'swf'      : '/static/img/uploadify.swf',// uploadify.swf 文件的相对JS文件的路径
        'uploader' : '/weserver/data/upload',//后台处理程序的相对路径
        'floder': '/upload/teachbanner',          
        'fileSizeLimit': '120KB',
        'queueID': 'fileQueue',
        'queueSizeLimit': 999999999,
        'uploadLimit': 999999999,
        //'progressData': 'speed',
        'auto': true,
        'multi': false,
        'buttonClass' : 'some-class',//自定义的样式类名
        //'queueID'  : 'some_file_queue',
        //'buttonCursor' : 'arrow',
        //'buttonText': '上传图片',
        'buttonTitle': '提示文字',
        'buttonImage':'/static/images/i/img/upload_file.png',
        'requeueErrors' : true,
        'debug': false,
        'height'   : 28, // The height of the flash button
        'width'    : 155, // The width of the flash button
        'itemTemplate':false,
        'successTimeout': 30,//设置文件上传后等待服务器响应的秒数，超出这个时间，将会被认为上传成功，默认为30秒
        'fileTypeExts': '*.bmp;*.jpg;.jpeg;*.png;*.gif',//设置允许上传的文件扩展名（也就是文件类型）。但手动键入文件名可以绕过这种级别的安全检查，所以你应该始终在服务端中检查文件类型。输入多个扩展名时用分号隔开('*.*;*.jpg;*.png;*.gif')
        'fileTypeDesc': '文件格式',//可选文件的描述。这个值出现在文件浏览窗口中的文件类型下拉选项中。（但我设置了好像没效果？原文：The description of the selectable files.  This string appears in the browse files dialog box in the file type drop down.）
        'fileObjName':'Filedata', //设置后台的文件名
        'method'   : 'post',
        'formData': {"uploadtype":"roomico"},
        'onUploadSuccess': function(file,data,response){
          if(data!=null){
            data = jQuery.parseJSON(data);
            if(data.status){
              $("input[name=RoomIcoFile]").val(data.url);
              $("#previewico").attr("src",data.url);
            }
          }
        },
        'onSelectError':function(file,data,response){
          if(data!=null){
            data = jQuery.parseJSON(data);
            if(data.status){
              var str = data.url;
              switch(errorCode) {
                case -110:
                    alert("文件 ["+str+"] 大小超出系统限制的" + jQuery('#Img').uploadify('settings', 'fileSizeLimit') + "大小！");
                    break;
                case -120:
                    alert("文件 ["+str+"] 大小异常！");
                    break;
                case -130:
                    alert("文件 ["+str+"] 类型不正确！");
                    break;
              }
            }
          }
        },
    });

    $('#RoomBanner').uploadify({
        'swf'      : '/static/img/uploadify.swf',// uploadify.swf 文件的相对JS文件的路径
        'uploader' : '/weserver/data/upload',//后台处理程序的相对路径
        'floder': '/upload/teachbanner',          
        'fileSizeLimit': '2MB',
        'queueID': 'fileQueue',
        'queueSizeLimit': 999999999,
        'uploadLimit': 999999999,
        //'progressData': 'speed',
        'auto': true,
        'multi': false,
        'buttonClass' : 'some-class',//自定义的样式类名
        //'queueID'  : 'some_file_queue',
        //'buttonCursor' : 'arrow',
        //'buttonText': '上传图片',
        'buttonTitle': '提示文字',
        'buttonImage':'/static/images/i/img/upload_file.png',
        'requeueErrors' : true,
        'debug': false,
        'height'   : 28, // The height of the flash button
        'width'    : 155, // The width of the flash button
        'itemTemplate':false,
        'successTimeout': 30,//设置文件上传后等待服务器响应的秒数，超出这个时间，将会被认为上传成功，默认为30秒
        'fileTypeExts': '*.bmp;*.jpg;.jpeg;*.png;*.gif',//设置允许上传的文件扩展名（也就是文件类型）。但手动键入文件名可以绕过这种级别的安全检查，所以你应该始终在服务端中检查文件类型。输入多个扩展名时用分号隔开('*.*;*.jpg;*.png;*.gif')
        'fileTypeDesc': '文件格式',//可选文件的描述。这个值出现在文件浏览窗口中的文件类型下拉选项中。（但我设置了好像没效果？原文：The description of the selectable files.  This string appears in the browse files dialog box in the file type drop down.）
        'fileObjName':'Filedata', //设置后台的文件名
        'method'   : 'post',
        'formData': {"uploadtype":"roombanner"},
        'onUploadSuccess': function(file,data,response){
          if(data!=null){
            data = jQuery.parseJSON(data);
            if(data.status){
              $("input[name=RoomBannerFile]").val(data.url);
              $("#previewbanner").attr("src",data.url);
            }
          }
        },
        'onSelectError':function(file,data,response){
          if(data!=null){
            data = jQuery.parseJSON(data);
            if(data.status){
              var str = data.url;
              switch(errorCode) {
                case -110:
                    alert("文件 ["+str+"] 大小超出系统限制的" + jQuery('#Img').uploadify('settings', 'fileSizeLimit') + "大小！");
                    break;
                case -120:
                    alert("文件 ["+str+"] 大小异常！");
                    break;
                case -130:
                    alert("文件 ["+str+"] 类型不正确！");
                    break;
              }
            }
          }
        },
    });

        $('#PcRoomad').uploadify({
        'swf'      : '/static/img/uploadify.swf',// uploadify.swf 文件的相对JS文件的路径
        'uploader' : '/weserver/data/upload',//后台处理程序的相对路径
        'floder': '/upload/teachbanner',          
        'fileSizeLimit': '2MB',
        'queueID': 'fileQueue',
        'queueSizeLimit': 999999999,
        'uploadLimit': 999999999,
        //'progressData': 'speed',
        'auto': true,
        'multi': false,
        'buttonClass' : 'some-class',//自定义的样式类名
        //'queueID'  : 'some_file_queue',
        //'buttonCursor' : 'arrow',
        //'buttonText': '上传图片',
        'buttonTitle': '提示文字',
        'buttonImage':'/static/images/i/img/upload_file.png',
        'requeueErrors' : true,
        'debug': false,
        'height'   : 28, // The height of the flash button
        'width'    : 155, // The width of the flash button
        'itemTemplate':false,
        'successTimeout': 30,//设置文件上传后等待服务器响应的秒数，超出这个时间，将会被认为上传成功，默认为30秒
        'fileTypeExts': '*.bmp;*.jpg;.jpeg;*.png;*.gif',//设置允许上传的文件扩展名（也就是文件类型）。但手动键入文件名可以绕过这种级别的安全检查，所以你应该始终在服务端中检查文件类型。输入多个扩展名时用分号隔开('*.*;*.jpg;*.png;*.gif')
        'fileTypeDesc': '文件格式',//可选文件的描述。这个值出现在文件浏览窗口中的文件类型下拉选项中。（但我设置了好像没效果？原文：The description of the selectable files.  This string appears in the browse files dialog box in the file type drop down.）
        'fileObjName':'Filedata', //设置后台的文件名
        'method'   : 'post',
        'formData': {"uploadtype":"PcRoomad"},
        'onUploadSuccess': function(file,data,response){
          if(data!=null){
            data = jQuery.parseJSON(data);
            if(data.status){
              $("input[name=PcRoomadFile]").val(data.url);
              $("#previewPcRoomad").attr("src",data.url);
            }
          }
        },
        'onSelectError':function(file,data,response){
          if(data!=null){
            data = jQuery.parseJSON(data);
            if(data.status){
              var str = data.url;
              switch(errorCode) {
                case -110:
                    alert("文件 ["+str+"] 大小超出系统限制的" + jQuery('#Img').uploadify('settings', 'fileSizeLimit') + "大小！");
                    break;
                case -120:
                    alert("文件 ["+str+"] 大小异常！");
                    break;
                case -130:
                    alert("文件 ["+str+"] 类型不正确！");
                    break;
              }
            }
          }
        },
    });

  });
</script>

<div class="crumb-wrap">
    <div class="crumb-list"><i class="icon-font"></i><a href="/public/index">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name"><a href="/weserver/data/room_index">房间管理</a></span><span class="crumb-step">&gt;</span><span class="crumb-name">修改房间</span></div>
</div>
<div class="am-g">
  <div class="am-u-lg-6">
    <form action="/weserver/data/room_edit" id="teachbannerform" class="am-form" method="post" enctype="multipart/form-data" data-am-validator>
      <fieldset>
        <legend></legend>
        <input type="hidden" name="action" value="edit"/>
        <input type="hidden" name="id" value="{{.roomInfo.Id}}" />
        <div class="am-form-group">
          <label for="doc-vld-Title-2">首页房间标题：</label>
          <input type="text" name="RoomTitle" value="{{.roomInfo.RoomTitle}}" id="doc-vld-Title-2" placeholder="房间标题" data-validation-message="请输入房间标题" required/>
        </div>

        <div class="am-form-group">
          <label for="doc-vld-Title-2">房间讲师：</label>
          <input type="text" name="RoomTeacher" value="{{.roomInfo.RoomTeacher}}" id="doc-vld-Title-2" placeholder="房间讲师" data-validation-message="请输入房间讲师"/>
        </div>

        <div class="am-form-group">
          <label for="doc-vld-Title-2">房间显示人数：</label>
          <input type="text" name="RoomNum" value="{{.roomInfo.RoomNum}}" id="doc-vld-Title-2" placeholder="显示人数" data-validation-message="请输入房间显示人数" required/>
        </div>

        <div class="am-form-group">
          <label for="doc-vld-Title-2">房间ICO(请上传128*128，文件为jpg,png文件)：</label>
            <input type="file" name="RoomIco" id="RoomIco" multiple="true"/>
            <input type="hidden" name="RoomIcoFile" value="{{.roomInfo.RoomIcon}}" id="RoomIcoFile" multiple="true"/> 
        </div>
        <div class="am-form-group" >
            <img id="previewico" src="{{.roomInfo.RoomIcon}}" style="width:128px;height: 128px;border: 0px;soild:#FFFFFF; " />
        </div>

        <div class="am-form-group">
          <label for="doc-vld-Title-2">房间简介：  <a class="am-icon-question-circle "data-am-popover="{theme: 'sm',content: '点击进入房间后下面简介', trigger: 'hover focus'}"></a></label>
            <textarea class="" name="RoomIntro" rows="5" id="doc-ta-1">{{.roomInfo.RoomIntro}}</textarea>
        </div>

        <div class="am-form-group">
          <label for="doc-vld-Title-2">房间banner(请上传750*440，文件为jpg,png文件)：</label>
            <input type="file" name="RoomBanner" id="RoomBanner" multiple="true" />
            <input type="hidden" name="RoomBannerFile" value="{{.roomInfo.RoomBanner}}" id="RoomBannerFile" multiple="true" /> 
        </div>
        <div class="am-form-group" >
            <img id="previewbanner" src="{{.roomInfo.RoomBanner}}" style="width:375px;height:220px;border: 0px;soild:#FFFFFF; " />
        </div>

                <div class="am-form-group">
          <label for="doc-vld-Title-2">房间名称  <a class="am-icon-question-circle "data-am-popover="{theme: 'sm',content: '点击进入房间后显示内容', trigger: 'hover focus'}"></a></label>
            <input type="text" name="Title" value="{{.roomInfo.Title}}"  multiple="true" placeholder="请输入房间名称" data-validation-message="请输入房间名称" /> 
        </div>

          <div class="am-form-group">
          <label for="doc-vld-Title-2">免责申明(仅PC端使用)：  <a class="am-icon-question-circle "data-am-popover="{theme: 'sm',content: '显示在PC端的免责声明', trigger: 'hover focus'}"></a></label>
            <textarea class="" name="PcRoomText" rows="5" id="doc-ta-1">{{.roomInfo.PcRoomText}}</textarea>
        </div>

                <div class="am-form-group">
          <label for="doc-vld-Title-2">广告图片(仅PC端使用,请上传750*440，文件为jpg,png文件)：</label>
            <input type="file" name="PcRoomad" id="PcRoomad" multiple="true" />
            <input type="hidden" name="PcRoomadFile" value="{{.roomInfo.PcRoomad}}" id="PcRoomadFile" multiple="true" /> 
        </div>
        <div class="am-form-group" >
            <img id="previewPcRoomad" src="{{.roomInfo.PcRoomad}}" style="width:375px;height:220px;border: 0px;soild:#FFFFFF; " />
        </div>



        <span class="am-btn am-btn-primary" data-am-collapse="{target: '#collapse-nav'}">高级设置 <i class="am-icon-angle-double-down"></i></span>
        <nav>
          <div id="collapse-nav" class="am-nav am-collapse">
            <div class="am-form-group">
              <label for="doc-vld-Title-2">MQTT_Groupid：<a class="am-icon-question-circle "data-am-popover="{theme: 'sm',content: '不填默认获取上次', trigger: 'hover focus'}"></a></label>
              <input type="text" name="GroupId" id="GroupId" value="{{.roomInfo.GroupId}}" placeholder="请输入goupid" data-validation-message="请输入goupid"/>
            </div>
            <div class="am-form-group">
              <label for="doc-vld-Title-2">URL：<a class="am-icon-question-circle "data-am-popover="{theme: 'sm',content: '不填默认获取上次', trigger: 'hover focus'}"></a></label>
              <input type="text" name="Url" id="Url" value="{{.roomInfo.Url}}" placeholder="请输入Url" data-validation-message="请输入Url"/>
            </div>
            <div class="am-form-group">
              <label for="doc-vld-Title-2">Port：<a class="am-icon-question-circle "data-am-popover="{theme: 'sm',content: '不填默认获取上次', trigger: 'hover focus'}"></a></label>
              <input type="text" name="Port" id="Port" value="{{.roomInfo.Port}}" placeholder="请输入Port" data-validation-message="请输入Port"/>
            </div>
            <div class="am-form-group">
              <label for="doc-select-1">tls  <a class="am-icon-question-circle "data-am-popover="{theme: 'sm',content: '不填默认获取上次', trigger: 'hover focus'}"></a></label>
              <label class="am-radio-inline">
                <input type="radio"  value="0" name="Tls" {{if eq .roomInfo.Tls false}}checked{{end}} required> 关闭
              </label>
              <label class="am-radio-inline">
                <input type="radio" value="1" name="Tls" {{if eq .roomInfo.Tls true}}checked{{end}}> 开启
              </label>
            </div>
            <div class="am-form-group">
              <label for="doc-vld-Title-2">Access：<a class="am-icon-question-circle "data-am-popover="{theme: 'sm',content: '不填默认获取上次', trigger: 'hover focus'}"></a></label>
              <input type="text" name="Access" id="Access" value="{{.roomInfo.Access}}" placeholder="请输入Access" data-validation-message="请输入Access"/>
            </div>
            <div class="am-form-group">
              <label for="doc-vld-Title-2">SecretKey：<a class="am-icon-question-circle "data-am-popover="{theme: 'sm',content: '不填默认获取上次', trigger: 'hover focus'}"></a></label>
              <input type="text" name="SecretKey" id="SecretKey" value="{{.roomInfo.SecretKey}}" placeholder="请输入SecretKey" data-validation-message="请输入SecretKey"/>
            </div>
          </div>
        </nav>
        <div class="am-form-group"></div>

        <button class="am-btn am-btn-secondary" type="submit">提交</button>
      </fieldset>
    </form>
  </div>
</div>

<script type="text/javascript">
$(function() {
  var RoomIcon = "{{.roomInfo.RoomIcon}}";
  var RoomBanner = "{{.roomInfo.RoomBanner}}";
  var PcRoomad = "{{.roomInfo.PcRoomad}}";
  if (RoomIcon.indexOf("upload") < 0){
      $("#previewico").attr("src","../../"+RoomIcon);
  }
  if (RoomBanner.indexOf("upload") < 0){
      $("#previewbanner").attr("src","../../"+RoomBanner);
  }
   if (PcRoomad.indexOf("upload") < 0){
      $("#previewPcRoomad").attr("src","../../"+PcRoomad);
  }


  $('#teachbannerform').validator({
    onValid: function(validity) {
      $(validity.field).closest('.am-form-group').find('.am-alert').hide();
    },

    onInValid: function(validity) {
      var $field = $(validity.field);
      var $group = $field.closest('.am-form-group');
      var $alert = $group.find('.am-alert');
      // 使用自定义的提示信息 或 插件内置的提示信息
      var msg = $field.data('validationMessage') || this.getValidationMessage(validity);

      if (!$alert.length) {
        $alert = $('<div class="am-alert am-alert-danger"></div>').hide().
          appendTo($group);
      }

      $alert.html(msg).show();
    }
  });
});
</script>